### NFT API Endpoints Testing (Environment Variable App IDs)
### Base URL: http://localhost:3000/api/v1/nft

# =======================
# POSITION NFT ENDPOINTS
# =======================

### Mint Position Token (for new investment)
POST http://localhost:3000/api/v1/nft/position/mint
Content-Type: application/json

{
  "userId": "6ed81d5d-d15b-41f1-825c-8eff55a1a9fd",
  "owner": "HXRUDXMK56MZE6ZZ3KGMMQFR2O7YKG4O6K3HPGFQXBLXXHEJTHY3VXGOTU",
  "assetType": 1,
  "holdings": "100000000",
  "purchaseValueUsd": "5000000"
}

### Update Position Token (when holdings change)
PUT http://localhost:3000/api/v1/nft/position/update
Content-Type: application/json

{
  "userId": "6ed81d5d-d15b-41f1-825c-8eff55a1a9fd",
  "positionTokenId": "1",
  "newHoldings": "150000000"
}

### Get Position NFT Contract Stats
GET http://localhost:3000/api/v1/nft/position/stats?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

### Check if Position Token Exists
GET http://localhost:3000/api/v1/nft/position/1/exists?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

### Get Position Token Owner
GET http://localhost:3000/api/v1/nft/position/1/owner?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

### Get Position Token Asset Type
GET http://localhost:3000/api/v1/nft/position/1/asset-type?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

### Get Position Token Holdings
GET http://localhost:3000/api/v1/nft/position/1/holdings?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

### Get Position Token Purchase Value
GET http://localhost:3000/api/v1/nft/position/1/purchase-value?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

### Get All Position Token Data (Convenience Endpoint)
GET http://localhost:3000/api/v1/nft/position/1?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

### Test Non-Existent Token (Should return exists: false)
GET http://localhost:3000/api/v1/nft/position/999/exists?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

### Test Multiple Token IDs (Replace with actual minted token IDs)
GET http://localhost:3000/api/v1/nft/position/2?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

### Get Position Token Purchase Value
GET http://localhost:3000/api/v1/nft/position/3?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

# =======================
# PORTFOLIO NFT ENDPOINTS
# =======================

### Mint Portfolio Token (for new user)
POST http://localhost:3000/api/v1/nft/portfolio/mint
Content-Type: application/json

{
  "userId": "6ed81d5d-d15b-41f1-825c-8eff55a1a9fd",
  "owner": "HXRUDXMK56MZE6ZZ3KGMMQFR2O7YKG4O6K3HPGFQXBLXXHEJTHY3VXGOTU",
  "level": 1,
  "metadataCid": "QmX54yZjWwsgxh85b78dkmvwfiBST7aT9J5ZiQp856x1jx"
}

### Add Position to Portfolio
POST http://localhost:3000/api/v1/nft/portfolio/add-position
Content-Type: application/json

{
  "userId": "6ed81d5d-d15b-41f1-825c-8eff55a1a9fd",
  "portfolioTokenId": "2",
  "positionTokenId": "2",
  "owner": "HXRUDXMK56MZE6ZZ3KGMMQFR2O7YKG4O6K3HPGFQXBLXXHEJTHY3VXGOTU"
}

### Get Portfolio NFT Contract Stats
GET http://localhost:3000/api/v1/nft/portfolio/stats?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

### Get Portfolio Position Count
GET http://localhost:3000/api/v1/nft/portfolio/position-count/2?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

### Get Which Portfolio a Position Belongs To
GET http://localhost:3000/api/v1/nft/portfolio/position-portfolio/1?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

### Get All Positions in a Portfolio (NEW!)
GET http://localhost:3000/api/v1/nft/portfolio/2/positions?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

### Get All Positions in Portfolio 1 (if it exists)
GET http://localhost:3000/api/v1/nft/portfolio/1/positions?userId=6ed81d5d-d15b-41f1-825c-8eff55a1a9fd

# =======================
# DEBUG/ADMIN ENDPOINTS
# =======================

### Fund Portfolio NFT Contract (for box storage)
# Uses deployer account with ALGO, not user account  
# Run this before minting portfolio tokens if contract needs funding
POST http://localhost:3000/api/v1/nft/debug/fund-portfolio-contract
Content-Type: application/json

{
  "amount": 100000
}

### Fund Portfolio NFT Contract (default amount)
# Uses default 0.1 ALGO funding amount
POST http://localhost:3000/api/v1/nft/debug/fund-portfolio-contract
Content-Type: application/json

{}

# =======================
# USER-CENTRIC PORTFOLIO APIs (RECOMMENDED)
# =======================

### Get User's Portfolio Info (Discovery)
GET http://localhost:3000/api/v1/users/6ed81d5d-d15b-41f1-825c-8eff55a1a9fd/portfolio

### Get User's Primary Portfolio with Full Details
GET http://localhost:3000/api/v1/users/6ed81d5d-d15b-41f1-825c-8eff55a1a9fd/portfolio/primary

### Get User's Portfolio Positions (User-Friendly)
GET http://localhost:3000/api/v1/users/6ed81d5d-d15b-41f1-825c-8eff55a1a9fd/portfolio/positions

### Create Portfolio for User (Mints NFT + Stores Mapping)
POST http://localhost:3000/api/v1/users/6ed81d5d-d15b-41f1-825c-8eff55a1a9fd/portfolio
Content-Type: application/json

{
  "algorandAddress": "HXRUDXMK56MZE6ZZ3KGMMQFR2O7YKG4O6K3HPGFQXBLXXHEJTHY3VXGOTU",
  "customName": "My Investment Portfolio",
  "level": 1,
  "metadataCid": "QmX54yZjWwsgxh85b78dkmvwfiBST7aT9J5ZiQp856x1jx"
}

### Update Portfolio Name
PUT http://localhost:3000/api/v1/users/6ed81d5d-d15b-41f1-825c-8eff55a1a9fd/portfolio/PORTFOLIO_UUID_HERE
Content-Type: application/json

{
  "customName": "My Bitcoin Stack"
}

# =======================
# COMBINED OPERATIONS
# =======================

### Create Investment with NFTs (Complete Flow)
# This mints a position token and adds it to a portfolio
POST http://localhost:3000/api/v1/nft/create-investment
Content-Type: application/json

{
  "userId": "6ed81d5d-d15b-41f1-825c-8eff55a1a9fd",
  "portfolioTokenId": "2",
  "owner": "HXRUDXMK56MZE6ZZ3KGMMQFR2O7YKG4O6K3HPGFQXBLXXHEJTHY3VXGOTU",
  "assetType": 1,
  "holdings": "200000000",
  "purchaseValueUsd": "10000000"
}

# =======================
# ENVIRONMENT SETUP
# =======================

### Required Environment Variables:
# Add to your .env file:
# POSITION_NFT_APP_ID=1001
# PORTFOLIO_NFT_APP_ID=2001

# =======================
# TEST DATA REFERENCE
# =======================

### Asset Types:
# 1 = Bitcoin
# 2 = Algorand  
# 3 = USDC

### Portfolio Levels:
# 1-5 (money tree growth levels)

### Example Test User Setup:
# 1. First create a test user via: POST /api/v1/debug/create-test-user
# 2. Get their Algorand address from wallet
# 3. Replace "ALGORAND_ADDRESS_HERE" with actual address
# 4. Replace "test-user-123" with actual user ID
# 5. Fund the Portfolio contract: POST /api/v1/nft/debug/fund-portfolio-contract

### Example Values:
# holdings: "100000000" = 1 BTC (8 decimal places)
# purchaseValueUsd: "5000000" = $50,000.00 (2 decimal places as cents)
# metadataCid: IPFS CID pointing to JSON metadata with portfolio details

### Position Token Getter Examples:
# Replace "1" with actual token ID from minting response
# GET /api/v1/nft/position/1/exists - Returns: { exists: true/false }
# GET /api/v1/nft/position/1/owner - Returns: { owner: "ALGORAND_ADDRESS", ownerBase64: "base64_bytes" }
# GET /api/v1/nft/position/1/asset-type - Returns: { assetType: "1", assetTypeName: "Bitcoin" }
# GET /api/v1/nft/position/1/holdings - Returns: { holdings: "100000000" }
# GET /api/v1/nft/position/1/purchase-value - Returns: { purchaseValue: "5000000" }
# GET /api/v1/nft/position/1 - Returns all position data in one call

### Portfolio Token Getter Examples:
# Replace "2" with actual portfolio token ID from minting response
# GET /api/v1/nft/portfolio/2/positions - Returns: { portfolioTokenId: "2", positionCount: 3, positions: [...] }
# GET /api/v1/nft/portfolio/position-portfolio/1 - Returns: { portfolioTokenId: "2" } (which portfolio position 1 belongs to)
# GET /api/v1/nft/portfolio/position-count/2 - Returns: { positionCount: "3" }

### Prerequisites:
# - Set POSITION_NFT_APP_ID and PORTFOLIO_NFT_APP_ID in .env
# - Position NFT contract deployed
# - Portfolio NFT contract deployed  
# - Test user created with wallet
# - Algorand localnet running